import os
import re

# List of common TLDs without the dot
TLDs = {
    'com',
    'org',
    'net',
    'int',
    'edu',
    'gov',
    'mil',
    'co',
    'io',
    'ai',
    'app',
    'dev',
    'tech',
    'xyz',
    'me',
    'info',
    'biz',
    'online',
    'site',
    'store',
    'blog',
    'us',
    'uk',
    'ca',
    'de',
    'jp',
    'fr',
    'au',
    'in',
    'cn',
    'br',
    'ru',
    'ch',
    'nl',
    'se',
    'es',
    'it',
    'pl',
    'ir',
    'za',
    'mx',
    'kr',
    'tr',
    'ar',
    'sg',
    'id',
    'hk',
    'tv',
    'fm',
    'ly',
    'to',
    'ws',
    'cc',
    'mobi',
    'name',
    'pro',
    'jobs',
    'tel',
    'asia',
    'travel',
    'museum',
    'cat',
    'coop',
    'aero',
    'int',
    'bank',
    'insurance',
    'law',
    'health',
    'finance',
    'credit',
    'cloud',
    'design',
    'agency',
    'studio',
    'media',
    'news',
    'press',
    'today',
    'email',
    'group',
    'company',
    'team',
    'network',
    'support',
    'systems',
    'solutions',
    'capital',
    'ventures',
    'life',
    'world',
    'zone',
    'space',
    'tools',
    'cool',
    'ninja',
    'expert',
    'love',
    'fun',
    'party',
    'vip',
    'games',
    'social',
    'photo',
    'pics',
    'camera',
    'gallery',
    'art',
    'music',
    'film',
    'theatre',
    'dance',
    'bar',
    'cafe',
    'restaurant',
    'pizza',
    'beer',
    'fashion',
    'style',
    'beauty',
    'makeup',
    'build',
    'construction',
    'contractors',
    'engineering',
    'software',
    'digital',
    'computer',
    'technology',
    'academy',
    'school',
    'college',
    'university',
    'education',
    'church',
    'bible',
    'faith',
    'christmas',
    'loc'
  }

# Directory to search
ROOT_DIR = "../vectors"

def is_flattened_domain(filename):
    name, ext = os.path.splitext(filename)
    if '.' in name:
        return False  # Properly separated, e.g. "google.com.svg"
    for tld in TLDs:
        if name.endswith(tld) and len(name) > len(tld):
            return True
    return False

for root, _, files in os.walk(ROOT_DIR):
    for file in files:
        if not file.lower().endswith(".svg"):
            continue

        name, _ = os.path.splitext(file)

        if is_flattened_domain(file):
            parent = os.path.basename(os.path.normpath(root))
            if name != parent and name.replace('.', '') != parent.replace('.', ''):
                print(f"Suspicious: {os.path.join(root, file)}")
